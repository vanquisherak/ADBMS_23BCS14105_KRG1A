
CREATE TABLE Year_tbl(
  ID int,
  YEAR int,
  NPV int,
);
TRUNCATE TABLE Year_tbl;
INSERT INTO Year_tbl VALUES(1,2018,100);
INSERT INTO Year_tbl VALUES(7,2020,30);
INSERT INTO Year_tbl VALUES(13,2019,40);
INSERT INTO Year_tbl VALUES(1,2019,113);
INSERT INTO Year_tbl VALUES(2,2008,121);
INSERT INTO Year_tbl VALUES(3,2009,12);
INSERT INTO Year_tbl VALUES(11,2020,99);
INSERT INTO Year_tbl VALUES(7,2019,0);

--SELECT * FROM Year_tbl;

CREATE TABLE Queries_tbl(
  ID int,
  YEAR int
);
INSERT INTO Queries_tbl VALUES(1,2019);
INSERT INTO Queries_tbl VALUES(2,2008);
INSERT INTO Queries_tbl VALUES(3,2009);
INSERT INTO Queries_tbl VALUES(7,2018);
INSERT INTO Queries_tbl VALUES(7,2019);
INSERT INTO Queries_tbl VALUES(7,2020);
INSERT INTO Queries_tbl VALUES(13,2019);
--SELECT * FROM Queries_tbl;

SELECT Q.ID,Q.YEAR,ISNULL(Y.NPV,0)AS NPV
FROM Queries_tbl AS Q 
LEFT OUTER JOIN
Year_tbl AS Y 
ON 
Y.ID=Q.ID
and
Y.YEAR=Q.YEAR
